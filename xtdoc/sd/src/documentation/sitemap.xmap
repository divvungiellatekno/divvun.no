<?xml version="1.0"?>
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">
 <map:components>
  <map:serializers>
   <map:serializer name="ical" 
     src="org.apache.cocoon.serialization.TextSerializer"
     mime-type="text/calendar" 
     logger="sitemap.serializer.text" 
   />
  </map:serializers>
 </map:components>
 <map:pipelines>
  <map:pipeline>

   <map:match pattern="**custom.xml">
    <map:generate src="{project:content.xdocs}{1}custom.xml" />
    <map:transform src="{project:resources.stylesheets}/hello2document.xsl" />
    <map:serialize type="xml"/>
   </map:match>

   <map:match pattern="**corpus-summary.xml">
    <map:generate src="{project:content.xdocs}{1}corpus-summary.xml" />
    <map:transform src="{project:resources.stylesheets}/corpus-summary2document.xsl" />
    <map:serialize type="xml"/>
   </map:match>

   <map:match pattern="**corpus-*.xml">
    <map:generate src="{project:content.xdocs}{1}corpus-content.xml" />
    <map:transform src="{project:resources.stylesheets}/corpus-lang-overview2document.xsl" >
      <map:parameter name="overviewlang" value="{2}"/>
    </map:transform>
    <map:transform type="i18n">
        <map:parameter name="locale" value="en"/>
    </map:transform>
    <map:serialize type="xml"/>
   </map:match>

   <!-- Will match weekly meeting files {2}, and extract the tasks for the
        person in {3}, returning the task list as an iCal TODO list -->
   <map:match pattern="**/Tasks_*_*.ics">
    <map:generate src="cocoon://{1}/Meeting_{2}.xml" />
    <map:transform src="{project:resources.stylesheets}/tasks2ical.xsl">
      <map:parameter name="person" value="{3}"/>
    </map:transform>
    <map:serialize type="ical"/>
   </map:match>

  </map:pipeline>
 </map:pipelines>
</map:sitemap>
